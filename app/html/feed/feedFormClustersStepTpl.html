<form name="feedForm">
  <div class="row">
    <div class="sourceReplicationButton"
      ng-repeat="cluster in feed.clusters"
      ng-click="handleCluster(cluster, $index)"
      ng-class="{active: cluster.selected}">
      <div>
        <span class="entypo"
          ng-class="{
            'circled-down': !cluster.selected || cluster.type === 'source' || archiveCluster.active,
            'circled-cross': cluster.selected && cluster.type !== 'source' && !archiveCluster.active
            }">
        </span>
      </div>
      <div><small>{{capitalize(cluster.type === 'target' ? (archiveCluster.active ? 'archive': 'replication') : cluster.type)}}</small> Cluster</div>
    </div>
    <div class="sourceReplicationButton pull-right"
      ng-click="addCluster()"
      ng-show="!archiveCluster.active">
      <div><span class="entypo circled-plus"></span></div>
      <div><small>Add</small>  Cluster</div>
    </div>
  </div>

  <div ng-repeat="cluster in feed.clusters" ng-show="cluster.selected">
    <div class="row">
      <h4 class="col-sm-24">{{capitalize(cluster.type)}} Cluster </h4>
    </div>

    <select ng-model="cluster.name" ng-required="true">
      <option ng-repeat="clusterItem in clusterList">{{clusterItem.name}}</option>
    </select>

    <h4 class="col-sm-24"> Retention </h4>

    <div class="col-sm-24 composedField">
      <select ng-model="cluster.retention.action"
        ng-required="true"
        ng-change="updateRetention()">
        <option selected value="chown">Chown</option>
        <option value="delete">Delete</option>
        <option value="chmod">Chmod</option>
        <option ng-show="cluster.type === 'source'" show value="archive">Archive</option>
      </select>
      in
      <input type="text" class="small"
        ng-required="true" ng-model="cluster.retention.quantity"
        ng-pattern="validations.twoDigits.pattern">

      <select ng-model="cluster.retention.unit"
        ng-required="true">
        <option selected value="hours">hours</option>
        <option value="days">days</option>
        <option value="weeks">weeks</option>
        <option value="months">months</option>
      </select>
    </div>

    <h4 class="col-sm-24"> Validity </h4>

    <div class="clearfix hidden-md"></div>

    <div class="col-sm-12">
      <label class="light">Start</label>
    </div>
    <div class="col-sm-12">
      <label class="light">End</label>
    </div>

    <div class="col-sm-6">
      <p class="input-group">
        <input type="text" class="form-control" datepicker-popup="{{startDatePicker.format}}"
          ng-model="cluster.validity.start.date"
          is-open="startDatePicker.opened"
          ng-required="true" />
        <span class="input-group-btn">
          <button type="button" class="btn btn-default" ng-click="startDatePicker.open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
        </span>
      </p>
    </div>
    <div class="col-sm-6">
      <input type="time" class="form-control"
        ng-required="true"/>
    </div>
    <div class="col-sm-6">
      <p class="input-group">
        <input type="text" class="form-control" datepicker-popup="{{endDatePicker.format}}"
          ng-model="cluster.validity.end.date"
          is-open="endDatePicker.opened"
          ng-required="true"/>
        <span class="input-group-btn">
          <button type="button" class="btn btn-default" ng-click="endDatePicker.open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
        </span>
      </p>
    </div>
    <div class="col-sm-6">
      <input type="time" class="form-control"
        ng-required="true"/>
    </div>

    <div class="clearfix hidden-md"></div>

    <div class="col-sm-24">
      <label class="light">Timezone</label>
    </div>

    <div class="clearfix hidden-md"></div>

    <div class="col-sm-24">
      <select class="padding0 TZSelect form-control" ng-model="feed.timezone">
        <option value=""></option>
        <option value="GMT-12:00">(GMT -12:00) Eniwetok, Kwajalein</option>
        <option value="GMT-11:00">(GMT -11:00) Midway Island, Samoa</option>
        <option value="GMT-10:00">(GMT -10:00) Hawaii</option>
        <option value="GMT-9:00">(GMT -9:00) Alaska</option>
        <option value="GMT-8:00">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
        <option value="GMT-7:00">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
        <option value="GMT-6:00">(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
        <option value="GMT-5:00">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
        <option value="GMT-4:00">(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz</option>
        <option value="GMT-3:50">(GMT -3:30) Newfoundland</option>
        <option value="GMT-3:00">(GMT -3:00) Brazil, Buenos Aires, Georgetown</option>
        <option value="GMT-2:00">(GMT -2:00) Mid-Atlantic</option>
        <option value="GMT-1:00">(GMT -1:00 hour) Azores, Cape Verde Islands</option>
        <option value="GMT+0:00">(GMT) Western Europe Time, London, Lisbon, Casablanca</option>
        <option value="GMT+1:00">(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris</option>
        <option value="GMT+2:00">(GMT +2:00) Kaliningrad, South Africa</option>
        <option value="GMT+3:00">(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg</option>
        <option value="GMT+3:50">(GMT +3:30) Tehran</option>
        <option value="GMT+4:00">(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi</option>
        <option value="GMT+4:50">(GMT +4:30) Kabul</option>
        <option value="GMT+5:00">(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
        <option value="GMT+5:50">(GMT +5:30) Bombay, Calcutta, Madras, New Delhi</option>
        <option value="GMT+5:75">(GMT +5:45) Kathmandu</option>
        <option value="GMT+6:00">(GMT +6:00) Almaty, Dhaka, Colombo</option>
        <option value="GMT+7:00">(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
        <option value="GMT+8:00">(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
        <option value="GMT+9:00">(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
        <option value="GMT+9:50">(GMT +9:30) Adelaide, Darwin</option>
        <option value="GMT+10:00">(GMT +10:00) Eastern Australia, Guam, Vladivostok</option>
        <option value="GMT+11:00">(GMT +11:00) Magadan, Solomon Islands, New Caledonia</option>
        <option value="GMT+12:00">(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
      </select>
    </div>


    <div class="row dynamic-table-spacer">

      <div class="col-sm-24 feedLocationNavBox">
        <h4 class="col-sm-10" ng-show="!feed.storage.fileSystem.active">Default Storage type</h4>
        <h4 class="col-sm-10" ng-show="feed.storage.fileSystem.active">Storage type</h4>

        <div class="col-sm-14 feedLocationNav">
          <div class="btn btn-default pull-right" ng-class="{active: feed.storage.catalog.active}">
            Catalog Storage
          </div>
          <div class="btn btn-default pull-right" ng-class="{active: feed.storage.fileSystem.active}">
            File System
          </div>
        </div>
      </div>

      <div class="clearfix hidden-md"></div>

      <div class="col-sm-19">
        <label>Location</label>
        <label class="light">(if not defined, will use default location)
        </label>
      </div>

      <div class="clearfix hidden-md"></div>

      <div class="col-sm-24"
        ng-show="feed.storage.fileSystem.active"
        ng-repeat="location in cluster.storage.fileSystem.locations">
        <label class="light">{{location.type}} path</label>
        <input type="text" class="form-control"
          ng-model="location.path" />
      </div>

      <div class="col-sm-24" ng-show="feed.storage.catalog.active">
        <label class="light">Table uri</label>
        <input type="text" class="form-control" ng-model="cluster.storage.catalog.catalogTable.uri"/>
      </div>
    </div>

  </div>

  <div class="row feedBottomButtons">
    <div class="btn btn-default col-sm-6" ui-sref="main.forms.feed.location">
      Previous
    </div>
    <div class="btn btn-default col-sm-6 pull-right"
         ng-disabled="feedForm.$invalid"
         ui-sref="main.forms.feed.summary">
      Next
    </div>
    <u class="col-sm-3 pull-right" ui-sref="main">
      Cancel
    </u>
  </div>
</form>